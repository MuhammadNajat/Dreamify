{"version":3,"file":"use-abort-signal.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/hooks/use-abort-signal.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,MAAM,EAAC,MAAM,KAAK,CAAA;AAC1B,OAAO,EAAC,eAAe,EAAE,QAAQ,EAAC,MAAM,OAAO,CAAA;AAE/C,MAAM,IAAI,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,OAAO,EAAE,CAAA;AAEpC,MAAM,CAAC,OAAO,UAAU,cAAc,CAAC,WAAyB,EAAE,UAA8C,IAAI;IAClH,MAAM,EAAC,IAAI,EAAE,UAAU,EAAC,GAAG,MAAM,EAAE,CAAA;IACnC,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAA;IAEjD,eAAe,CAAC,GAAG,EAAE;QACnB,WAAW,EAAE,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;YAC1C,MAAM,cAAc,GAAG,WAAW,EAAE,MAAM,CAAC,OAAO,KAAK,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,WAAW,EAAE,MAAM,CAAA;YACrG,OAAO,CAAC,cAAc,CAAC;iBACpB,IAAI,CAAC,GAAG,EAAE;gBACT,YAAY,CAAC,IAAI,CAAC,CAAA;gBAClB,UAAU,CAAC,cAAc,CAAC,CAAA;YAC5B,CAAC,CAAC;iBACD,KAAK,CAAC,GAAG,EAAE,GAAE,CAAC,CAAC,CAAA;QACpB,CAAC,CAAC,CAAA;IACJ,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO,EAAC,SAAS,EAAC,CAAA;AACpB,CAAC","sourcesContent":["import {AbortSignal} from '../../../../public/node/abort.js'\nimport {useApp} from 'ink'\nimport {useLayoutEffect, useState} from 'react'\n\nconst noop = () => Promise.resolve()\n\nexport default function useAbortSignal(abortSignal?: AbortSignal, onAbort: (error?: unknown) => Promise<void> = noop) {\n  const {exit: unmountInk} = useApp()\n  const [isAborted, setIsAborted] = useState(false)\n\n  useLayoutEffect(() => {\n    abortSignal?.addEventListener('abort', () => {\n      const abortWithError = abortSignal?.reason.message === 'AbortError' ? undefined : abortSignal?.reason\n      onAbort(abortWithError)\n        .then(() => {\n          setIsAborted(true)\n          unmountInk(abortWithError)\n        })\n        .catch(() => {})\n    })\n  }, [])\n\n  return {isAborted}\n}\n"]}