{"version":3,"file":"GitDiff.js","sourceRoot":"","sources":["../../../../../../src/private/node/ui/components/Prompts/GitDiff.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAC,QAAQ,EAAE,mBAAmB,EAAC,MAAM,sCAAsC,CAAA;AAClF,OAAO,EAAC,IAAI,EAAC,MAAM,KAAK,CAAA;AACxB,OAAO,KAA0B,MAAM,OAAO,CAAA;AAC9C,OAAO,EAAC,aAAa,EAAC,MAAM,QAAQ,CAAA;AAEpC,MAAM,OAAO,GAAG,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;AAC9C,MAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,CAAA;AASnC;;;;;;;GAOG;AACH,MAAM,OAAO,GAAoC,CAAC,EAAC,OAAO,EAAE,EAAC,eAAe,EAAE,cAAc,EAAC,EAAC,EAAe,EAAE;IAC7G,MAAM,eAAe,GAAG,OAAO,CAAC,eAAe,EAAE,cAAc,EAAE;QAC/D,KAAK,EAAE,mBAAmB,EAAE;QAC5B,uDAAuD;QACvD,KAAK,EAAE,oCAAoC;QAC3C,SAAS,EAAE,IAAI;KAChB,CAAC,CAAA;IACF,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,oBAAC,IAAI,sBAAmB,CAAA;KAChC;IACD,MAAM,YAAY,GAAG,eAAe;SACjC,KAAK,CAAC,IAAI,CAAC;SACX,GAAG,CAAC,CAAC,IAAY,EAAE,KAAa,EAAsB,EAAE;QACvD,MAAM,YAAY,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAA;QACnC,IAAI,YAAY,KAAK,8BAA8B,EAAE;YACnD,OAAO,SAAS,CAAA;SACjB;aAAM,IAAI,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;YACpC,MAAM,UAAU,GAAG,KAAK,KAAK,CAAC,CAAA;YAC9B,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAA;SAC3D;aAAM;YACL,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,KAAK,EAAE,EAAE;gBACxC,OAAO,GAAG,KAAK,GAAG,CAAA;YACpB,CAAC,CAAC,CAAA;SACH;IACH,CAAC,CAAC;SACD,MAAM,CAAC,CAAC,IAAwB,EAAE,EAAE,CAAC,IAAI,KAAK,SAAS,CAAC;SACxD,IAAI,CAAC,IAAI,CAAC;SACV,OAAO,EAAE,CAAA;IACZ,OAAO,oBAAC,IAAI,QAAE,YAAY,CAAQ,CAAA;AACpC,CAAC,CAAA;AAED,OAAO,EAAC,OAAO,EAAC,CAAA","sourcesContent":["import {unstyled, shouldDisplayColors} from '../../../../../public/node/output.js'\nimport {Text} from 'ink'\nimport React, {FunctionComponent} from 'react'\nimport {createRequire} from 'module'\n\nconst require = createRequire(import.meta.url)\nconst gitDiff = require('git-diff')\n\nexport interface GitDiffProps {\n  gitDiff: {\n    baselineContent: string\n    updatedContent: string\n  }\n}\n\n/**\n * `GitDiff` displays a git diff between two strings.\n * @example\n *   \\@\\@ -1,2 +1,2 \\@\\@\n * - deleted line\n *   unchanged line\n * + added line\n */\nconst GitDiff: FunctionComponent<GitDiffProps> = ({gitDiff: {baselineContent, updatedContent}}): JSX.Element => {\n  const rawDiffContents = gitDiff(baselineContent, updatedContent, {\n    color: shouldDisplayColors(),\n    // Show minimal context to accommodate small terminals.\n    flags: '--unified=1 --inter-hunk-context=1',\n    noHeaders: true,\n  })\n  if (!rawDiffContents) {\n    return <Text>No changes.</Text>\n  }\n  const diffContents = rawDiffContents\n    .split('\\n')\n    .map((line: string, index: number): string | undefined => {\n      const unstyledLine = unstyled(line)\n      if (unstyledLine === '\\\\ No newline at end of file') {\n        return undefined\n      } else if (unstyledLine.match(/^@@/)) {\n        const addNewline = index !== 0\n        return line.replace('@@', `${addNewline ? '\\n' : ''}  @@`)\n      } else {\n        return line.replace(/([+\\- ])/, (match) => {\n          return `${match} `\n        })\n      }\n    })\n    .filter((line: string | undefined) => line !== undefined)\n    .join('\\n')\n    .trimEnd()\n  return <Text>{diffContents}</Text>\n}\n\nexport {GitDiff}\n"]}