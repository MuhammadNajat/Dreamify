{"version":3,"file":"update-url.js","sourceRoot":"","sources":["../../../../src/cli/commands/app/update-url.ts"],"names":[],"mappings":"AAAA,OAAO,OAAO,MAAM,gCAAgC,CAAA;AACpD,OAAO,SAA6B,MAAM,kCAAkC,CAAA;AAC5E,OAAO,EAAC,4BAA4B,EAAC,MAAM,uCAAuC,CAAA;AAClF,OAAO,EAAC,QAAQ,EAAC,MAAM,gBAAgB,CAAA;AACvC,OAAO,EAAC,oBAAoB,EAAC,MAAM,4BAA4B,CAAA;AAC/D,OAAO,EAAC,KAAK,EAAC,MAAM,aAAa,CAAA;AACjC,OAAO,EAAC,WAAW,EAAC,MAAM,2BAA2B,CAAA;AAErD,MAAqB,SAAU,SAAQ,OAAO;IA8BrC,KAAK,CAAC,GAAG;QACd,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;QAC3C,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE;YACpB,MAAM,4BAA4B,EAAE,CAAA;SACrC;QACD,MAAM,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,CAAA;QAErD,MAAM,GAAG,GAAG,MAAM,oBAAoB,CAAC;YACrC,UAAU,EAAE,KAAK,CAAC,MAAM;YACxB,SAAS,EAAE,KAAK,CAAC,IAAI;SACtB,CAAC,CAAA;QAEF,MAAM,OAAO,GAAqB;YAChC,MAAM;YACN,MAAM,EAAE,KAAK,CAAC,SAAS,CAAC;YACxB,YAAY,EAAE,KAAK,CAAC,eAAe,CAAC,EAAE,KAAK,CAAC,GAAG,CAAC;YAChD,GAAG;SACJ,CAAA;QACD,MAAM,SAAS,CAAC,OAAO,CAAC,CAAA;IAC1B,CAAC;;AAhDM,qBAAW,GAAG,8DAA8D,CAAA;AAE5E,eAAK,GAAG;IACb,GAAG,WAAW;IACd,GAAG,QAAQ;IACX,SAAS,EAAE,KAAK,CAAC,MAAM,CAAC;QACtB,MAAM,EAAE,IAAI;QACZ,WAAW,EAAE,0BAA0B;QACvC,GAAG,EAAE,0BAA0B;QAC/B,SAAS,EAAE,CAAC,QAAQ,CAAC;KACtB,CAAC;IACF,WAAW,EAAE,KAAK,CAAC,MAAM,CAAC;QACxB,MAAM,EAAE,KAAK;QACb,WAAW,EAAE,4BAA4B;QACzC,GAAG,EAAE,wBAAwB;QAC7B,SAAS,EAAE,CAAC,QAAQ,CAAC;KACtB,CAAC;IACF,SAAS,EAAE,KAAK,CAAC,MAAM,CAAC;QACtB,MAAM,EAAE,KAAK;QACb,WAAW,EAAE,mDAAmD;QAChE,GAAG,EAAE,sBAAsB;KAC5B,CAAC;IACF,eAAe,EAAE,KAAK,CAAC,MAAM,CAAC;QAC5B,MAAM,EAAE,KAAK;QACb,WAAW,EAAE,gGAAgG;QAC7G,GAAG,EAAE,4BAA4B;KAClC,CAAC;CACH,CAAA;eA5BkB,SAAS","sourcesContent":["import Command from '../../utilities/app-command.js'\nimport updateURL, {UpdateURLOptions} from '../../services/app/update-url.js'\nimport {showApiKeyDeprecationWarning} from '../../prompts/deprecation-warnings.js'\nimport {appFlags} from '../../flags.js'\nimport {loadAppConfiguration} from '../../models/app/loader.js'\nimport {Flags} from '@oclif/core'\nimport {globalFlags} from '@shopify/cli-kit/node/cli'\n\nexport default class UpdateURL extends Command {\n  static description = 'Update your app and redirect URLs in the Partners Dashboard.'\n\n  static flags = {\n    ...globalFlags,\n    ...appFlags,\n    'api-key': Flags.string({\n      hidden: true,\n      description: 'The API key of your app.',\n      env: 'SHOPIFY_FLAG_APP_API_KEY',\n      exclusive: ['config'],\n    }),\n    'client-id': Flags.string({\n      hidden: false,\n      description: 'The Client ID of your app.',\n      env: 'SHOPIFY_FLAG_CLIENT_ID',\n      exclusive: ['config'],\n    }),\n    'app-url': Flags.string({\n      hidden: false,\n      description: 'URL through which merchants will access your app.',\n      env: 'SHOPIFY_FLAG_APP_URL',\n    }),\n    'redirect-urls': Flags.string({\n      hidden: false,\n      description: 'Comma separated list of allowed URLs where merchants are redirected after the app is installed',\n      env: 'SHOPIFY_FLAG_REDIRECT_URLS',\n    }),\n  }\n\n  public async run(): Promise<void> {\n    const {flags} = await this.parse(UpdateURL)\n    if (flags['api-key']) {\n      await showApiKeyDeprecationWarning()\n    }\n    const apiKey = flags['client-id'] || flags['api-key']\n\n    const app = await loadAppConfiguration({\n      configName: flags.config,\n      directory: flags.path,\n    })\n\n    const options: UpdateURLOptions = {\n      apiKey,\n      appURL: flags['app-url'],\n      redirectURLs: flags['redirect-urls']?.split(','),\n      app,\n    }\n    await updateURL(options)\n  }\n}\n"]}