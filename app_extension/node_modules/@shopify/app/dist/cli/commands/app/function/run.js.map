{"version":3,"file":"run.js","sourceRoot":"","sources":["../../../../../src/cli/commands/app/function/run.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,aAAa,EAAE,iBAAiB,EAAC,MAAM,sCAAsC,CAAA;AACrF,OAAO,EAAC,iBAAiB,EAAC,MAAM,qCAAqC,CAAA;AACrE,OAAO,EAAC,QAAQ,EAAC,MAAM,mBAAmB,CAAA;AAC1C,OAAO,OAAO,MAAM,oCAAoC,CAAA;AACxD,OAAO,EAAC,WAAW,EAAC,MAAM,2BAA2B,CAAA;AACrD,OAAO,EAAC,KAAK,EAAC,MAAM,aAAa,CAAA;AAEjC,MAAqB,WAAY,SAAQ,OAAO;IA2BvC,KAAK,CAAC,GAAG;QACd,MAAM,EAAC,KAAK,EAAC,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;QAC7C,MAAM,iBAAiB,CAAC;YACtB,aAAa,EAAE,IAAI,CAAC,MAAM;YAC1B,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,UAAU,EAAE,KAAK,CAAC,MAAM;YACxB,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,WAAW,EAAE,EAAE;gBACpC,MAAM,iBAAiB,CAAC,WAAW,EAAE;oBACnC,IAAI,EAAE,KAAK,CAAC,IAAI;oBAChB,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,MAAM,EAAE,KAAK,CAAC,MAAM;iBACrB,CAAC,CAAA;YACJ,CAAC;SACF,CAAC,CAAA;IACJ,CAAC;;AAxCM,uBAAW,GAAG,qCAAqC,CAAA;AAEnD,iBAAK,GAAG;IACb,GAAG,WAAW;IACd,GAAG,QAAQ;IACX,GAAG,aAAa;IAChB,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC;QAClB,IAAI,EAAE,GAAG;QACT,WAAW,EAAE,6EAA6E;QAC1F,GAAG,EAAE,oBAAoB;KAC1B,CAAC;IACF,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC;QACnB,IAAI,EAAE,GAAG;QACT,MAAM,EAAE,KAAK;QACb,WAAW,EAAE,oCAAoC;QACjD,OAAO,EAAE,QAAQ;QACjB,GAAG,EAAE,qBAAqB;KAC3B,CAAC;IACF,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC;QAClB,IAAI,EAAE,GAAG;QACT,MAAM,EAAE,KAAK;QACb,WAAW,EAAE,sCAAsC;QACnD,GAAG,EAAE,mBAAmB;KACzB,CAAC;CACH,CAAA;eAzBkB,WAAW","sourcesContent":["import {functionFlags, inFunctionContext} from '../../../services/function/common.js'\nimport {runFunctionRunner} from '../../../services/function/build.js'\nimport {appFlags} from '../../../flags.js'\nimport Command from '@shopify/cli-kit/node/base-command'\nimport {globalFlags} from '@shopify/cli-kit/node/cli'\nimport {Flags} from '@oclif/core'\n\nexport default class FunctionRun extends Command {\n  static description = 'Run a function locally for testing.'\n\n  static flags = {\n    ...globalFlags,\n    ...appFlags,\n    ...functionFlags,\n    input: Flags.string({\n      char: 'i',\n      description: 'The input JSON to pass to the function. If omitted, standard input is used.',\n      env: 'SHOPIFY_FLAG_INPUT',\n    }),\n    export: Flags.string({\n      char: 'e',\n      hidden: false,\n      description: 'Name of the wasm export to invoke.',\n      default: '_start',\n      env: 'SHOPIFY_FLAG_EXPORT',\n    }),\n    json: Flags.boolean({\n      char: 'j',\n      hidden: false,\n      description: 'Log the run result as a JSON object.',\n      env: 'SHOPIFY_FLAG_JSON',\n    }),\n  }\n\n  public async run() {\n    const {flags} = await this.parse(FunctionRun)\n    await inFunctionContext({\n      commandConfig: this.config,\n      path: flags.path,\n      configName: flags.config,\n      callback: async (_app, ourFunction) => {\n        await runFunctionRunner(ourFunction, {\n          json: flags.json,\n          input: flags.input,\n          export: flags.export,\n        })\n      },\n    })\n  }\n}\n"]}