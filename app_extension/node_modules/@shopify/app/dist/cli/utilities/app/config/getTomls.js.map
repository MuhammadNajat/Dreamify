{"version":3,"file":"getTomls.js","sourceRoot":"","sources":["../../../../../src/cli/utilities/app/config/getTomls.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,qBAAqB,EAAC,MAAM,+BAA+B,CAAA;AACnE,OAAO,EAAC,QAAQ,EAAC,MAAM,4BAA4B,CAAA;AACnD,OAAO,EAAC,WAAW,EAAC,MAAM,IAAI,CAAA;AAE9B,MAAM,CAAC,KAAK,UAAU,QAAQ,CAAC,YAAqB;IAClD,IAAI,CAAC,YAAY,EAAE;QACjB,OAAO,EAAE,CAAA;KACV;IAED,MAAM,KAAK,GAAG,iCAAiC,CAAA;IAC/C,MAAM,SAAS,GAA4B,EAAE,CAAA;IAE7C,MAAM,KAAK,GAAG,WAAW,CAAC,YAAY,CAAC,CAAA;IACvC,MAAM,OAAO,CAAC,GAAG,CACf,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE;QACvB,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YACpB,MAAM,QAAQ,GAAG,QAAQ,CAAC,YAAY,EAAE,IAAI,CAAC,CAAA;YAC7C,8DAA8D;YAC9D,MAAM,UAAU,GAAG,CAAC,MAAM,qBAAqB,CAAC,QAAQ,CAAC,CAAyB,CAAA;YAElF,IAAI,UAAU,CAAC,SAAS,EAAE;gBACxB,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,IAAI,CAAA;aACvC;SACF;IACH,CAAC,CAAC,CACH,CAAA;IAED,OAAO,SAAS,CAAA;AAClB,CAAC","sourcesContent":["import {loadConfigurationFile} from '../../../models/app/loader.js'\nimport {joinPath} from '@shopify/cli-kit/node/path'\nimport {readdirSync} from 'fs'\n\nexport async function getTomls(appDirectory?: string) {\n  if (!appDirectory) {\n    return {}\n  }\n\n  const regex = /^shopify\\.app(\\.[-\\w]+)?\\.toml$/\n  const clientIds: {[key: string]: string} = {}\n\n  const files = readdirSync(appDirectory)\n  await Promise.all(\n    files.map(async (file) => {\n      if (regex.test(file)) {\n        const filePath = joinPath(appDirectory, file)\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const parsedToml = (await loadConfigurationFile(filePath)) as {[key: string]: any}\n\n        if (parsedToml.client_id) {\n          clientIds[parsedToml.client_id] = file\n        }\n      }\n    }),\n  )\n\n  return clientIds\n}\n"]}