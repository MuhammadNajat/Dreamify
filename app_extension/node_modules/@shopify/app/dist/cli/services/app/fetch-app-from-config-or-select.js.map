{"version":3,"file":"fetch-app-from-config-or-select.js","sourceRoot":"","sources":["../../../../src/cli/services/app/fetch-app-from-config-or-select.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,SAAS,EAAC,MAAM,iBAAiB,CAAA;AACzC,OAAO,EAA4B,kBAAkB,EAAC,MAAM,yBAAyB,CAAA;AACrF,OAAO,EAAC,yBAAyB,EAAC,MAAM,iBAAiB,CAAA;AACzD,OAAO,EAAC,yBAAyB,EAAC,MAAM,eAAe,CAAA;AAEvD,OAAO,EAAC,2BAA2B,EAAC,MAAM,+BAA+B,CAAA;AACzE,OAAO,EAAC,UAAU,EAAC,MAAM,6BAA6B,CAAA;AAEtD,MAAM,CAAC,KAAK,UAAU,0BAA0B,CAAC,GAA8B;IAC7E,IAAI,eAAe,CAAA;IACnB,IAAI,kBAAkB,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE;QACzC,MAAM,KAAK,GAAG,MAAM,2BAA2B,EAAE,CAAA;QACjD,MAAM,MAAM,GAAG,GAAG,CAAC,aAAa,CAAC,SAAS,CAAA;QAC1C,eAAe,GAAG,MAAM,yBAAyB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;QAChE,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,YAAY,GAAG,yBAAyB,CAAC,MAAM,CAAC,CAAA;YACtD,MAAM,IAAI,UAAU,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC,UAAU,CAAC,CAAA;SACpE;KACF;SAAM;QACL,eAAe,GAAG,MAAM,SAAS,EAAE,CAAA;KACpC;IACD,OAAO,eAAe,CAAA;AACxB,CAAC","sourcesContent":["import {selectApp} from './select-app.js'\nimport {AppConfigurationInterface, isCurrentAppSchema} from '../../models/app/app.js'\nimport {fetchAppDetailsFromApiKey} from '../dev/fetch.js'\nimport {InvalidApiKeyErrorMessage} from '../context.js'\nimport {OrganizationApp} from '../../models/organization.js'\nimport {ensureAuthenticatedPartners} from '@shopify/cli-kit/node/session'\nimport {AbortError} from '@shopify/cli-kit/node/error'\n\nexport async function fetchAppFromConfigOrSelect(app: AppConfigurationInterface): Promise<OrganizationApp> {\n  let organizationApp\n  if (isCurrentAppSchema(app.configuration)) {\n    const token = await ensureAuthenticatedPartners()\n    const apiKey = app.configuration.client_id\n    organizationApp = await fetchAppDetailsFromApiKey(apiKey, token)\n    if (!organizationApp) {\n      const errorMessage = InvalidApiKeyErrorMessage(apiKey)\n      throw new AbortError(errorMessage.message, errorMessage.tryMessage)\n    }\n  } else {\n    organizationApp = await selectApp()\n  }\n  return organizationApp\n}\n"]}